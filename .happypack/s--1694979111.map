{"version":3,"sources":["src/modules/directives/scroll.js"],"names":["startTime","startY","oldY","$el","$event","currentY","distance","deceleration","minValue","maxValue","getTranslateY","dom","transformString","style","transform","Number","match","handleTouchStart","event","preventDefault","Date","getTime","targetTouches","screenY","handleTouchMove","Math","abs","temDis","dispatchEvent","handleTouchEnd","duration","speed","destination","setTimeout","scroll","bind","el","binding","vnode","inserted","clientHeight","window","screen","height","Event","addEventListener","update","componentUpdated","unbind"],"mappings":"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","file":"scroll.js","sourceRoot":"/Users/yejiaming/Desktop/jmyour/vue-ui","sourcesContent":["/**\n * Created by yejiaming on 2017/9/28.\n */\n/**\n * Created by yejiaming on 2017/2/23.\n */\nvar startTime, startY, oldY, $el, $event, currentY, distance, deceleration = 0.0006, minValue = 0, maxValue;\n\nvar getTranslateY = function (dom) {\n    var transformString = dom.style.transform;\n    if (transformString) {\n        return Number(transformString.match(/\\+?\\-?\\d+/g)[0]);\n    } else {\n        return 0;\n    }\n};\n\nvar handleTouchStart = function (event) {\n    event.preventDefault();\n    startTime = new Date().getTime();\n    startY = event.targetTouches[0].screenY;\n    /*每次移动开始时设置初始的oldY的值*/\n    oldY = getTranslateY($el);\n    $el.style[\"transitionDuration\"] = '0ms';\n};\n\nvar handleTouchMove = function (event) {\n    event.preventDefault();\n    currentY = event.targetTouches[0].screenY;\n    distance = currentY - startY;\n    if (Math.abs(distance)<= 10) {\n        return;\n    }\n    let temDis = distance + oldY;\n    $el.style[\"-webkit-transform\"] = 'translateY(' + temDis + 'px)';\n    $el.dispatchEvent($event);\n};\n\nvar handleTouchEnd = function (event) {\n    event.preventDefault();\n    let temDis = distance + oldY;\n    /*计算缓动值*/\n    var duration = new Date().getTime() - startTime;\n    // 300毫秒是判断间隔的最佳时间\n    if (duration < 300 && Math.abs(distance) > 10) {\n        var speed = Math.abs(distance) / duration,\n            destination;  // 加速度因子\n        // 初速度为0 距离等于速度的平方除以2倍加速度\n        destination = (speed * speed) / (2 * deceleration) * (distance < 0 ? -1 : 1);\n        // 初始时间为0，初始速度为0 时间等于速度除以加速度\n        duration = speed / deceleration;\n        temDis += destination;\n    }\n    /*设置最小值*/\n    if (temDis > minValue) {\n        temDis = minValue;\n    }\n    /*设置最大值*/\n    if (temDis < -maxValue) {\n        temDis = -maxValue;\n    }\n    $el.style[\"transitionDuration\"] = '1000ms';\n    $el.style[\"transitionTimingFunction\"] = 'ease-out';\n    /*确定最终的滚动位置*/\n    setTimeout(()=> {\n        $el.style[\"-webkit-transform\"] = 'translateY(' + temDis + 'px)';\n    }, 0);\n    $el.dispatchEvent($event);\n};\n\nexport var scroll = {\n    // 当绑定元素插入到 DOM 中。\n    bind: function (el, binding, vnode) {\n        // console.log('首次加载挂载到DOM节点中——一次挂载之运行一次');\n    },\n    inserted: function (el, binding) {\n        $el = el;\n        maxValue = $el.clientHeight - window.screen.height;\n        // console.log('DOM节点挂载到完毕——一次挂载之运行一次');\n        $event = new Event('y-scroll');\n        el.addEventListener('touchstart', handleTouchStart);\n        el.addEventListener('touchmove', handleTouchMove);\n        el.addEventListener('touchend', handleTouchEnd);\n    },\n    update: function (el, binding) {\n\n    },\n    componentUpdated: function (el, binding) {\n        // console.log('完成更新DOM节点或者绑定数据——一次挂载之运行多次');\n    },\n    unbind: function (el, binding) {\n        // console.log('取消该节点的挂载——一次挂载之运行一次');\n    }\n};\n"]}
{"version":3,"sources":["src/modules/directives/scroll.js"],"names":["startTime","startY","oldY","$el","$event","currentY","distance","deceleration","minValue","resetY","maxValue","currentTime","lastY","lastTime","getTranslateY","dom","transformString","style","transform","Number","match","getScrollEventTarget","element","currentNode","tagName","nodeType","overflowY","document","defaultView","getComputedStyle","parentNode","window","handleTouchStart","event","Date","getTime","targetTouches","screenY","handleTouchMove","preventDefault","Math","abs","temDis","dispatchEvent","handleTouchEnd","duration","resetDistance","speed","destination","setTimeout","scrollFunc","e","stopPropagation","returnvalue","scroll","bind","el","binding","vnode","inserted","clientHeight","documentElement","scrollTarge","addEventListener","Event","update","componentUpdated","unbind"],"mappings":"AAAA;;;AAGA;;;AAGA,IAAIA,SAAJ;AAAA,IAAeC,MAAf;AAAA,IAAuBC,IAAvB;AAAA,IAA6BC,GAA7B;AAAA,IAAkCC,MAAlC;AAAA,IAA0CC,QAA1C;AAAA,IAAoDC,QAApD;AAAA,IAA8DC,eAAe,MAA7E;AAAA,IAAqFC,WAAW,CAAhG;AAAA,IAAmGC,MAAnG;AAAA,IAA2GC,QAA3G;AAAA,IAAqHC,WAArH;AAAA,IAAkIC,QAAQ,CAA1I;AAAA,IAA6IC,QAA7I;;AAEA,IAAIC,gBAAgB,UAAUC,GAAV,EAAe;AAC/B,QAAIC,kBAAkBD,IAAIE,KAAJ,CAAUC,SAAhC;AACA,QAAIF,eAAJ,EAAqB;AACjB,eAAOG,OAAOH,gBAAgBI,KAAhB,CAAsB,YAAtB,EAAoC,CAApC,CAAP,CAAP;AACH,KAFD,MAEO;AACH,eAAO,CAAP;AACH;AACJ,CAPD;AAQA,IAAIC,uBAAuB,UAAUC,OAAV,EAAmB;AAC1C,QAAIC,cAAcD,OAAlB;AACA,WAAOC,eAAeA,YAAYC,OAAZ,KAAwB,MAAvC,IACPD,YAAYC,OAAZ,KAAwB,MADjB,IAC2BD,YAAYE,QAAZ,KAAyB,CAD3D,EAC8D;AAC1D,YAAIC,YAAYC,SAASC,WAAT,CAAqBC,gBAArB,CAAsCN,WAAtC,EAAmDG,SAAnE;AACA,YAAIA,cAAc,QAAd,IAA0BA,cAAc,MAA5C,EAAoD;AAChD,mBAAOH,WAAP;AACH;AACDA,sBAAcA,YAAYO,UAA1B;AACH;AACD,WAAOC,MAAP;AACH,CAXD;;AAaA,IAAIC,mBAAmB,UAAUC,KAAV,EAAiB;AACpCpB,eAAWb,YAAY,IAAIkC,IAAJ,GAAWC,OAAX,EAAvB;AACA7B,eAAW,CAAX;AACAG,aAASR,SAASgC,MAAMG,aAAN,CAAoB,CAApB,EAAuBC,OAAzC;AACA;AACAnC,WAAOY,cAAcX,GAAd,CAAP;AACAA,QAAIc,KAAJ,CAAU,oBAAV,IAAkC,KAAlC;AACH,CAPD;;AASA,IAAIqB,kBAAkB,UAAUL,KAAV,EAAiB;AACnCA,UAAMM,cAAN;AACAlC,eAAW4B,MAAMG,aAAN,CAAoB,CAApB,EAAuBC,OAAlC;AACA1B,kBAAc,IAAIuB,IAAJ,GAAWC,OAAX,EAAd;AACA;AACA,QAAIK,KAAKC,GAAL,CAASpC,WAAWO,KAApB,IAA6B4B,KAAKC,GAAL,CAAS9B,cAAcE,QAAvB,CAA7B,GAAgE,IAApE,EAA0E;AACtEb,oBAAY,IAAIkC,IAAJ,GAAWC,OAAX,EAAZ;AACA1B,iBAASJ,QAAT;AACH;AACDC,eAAWD,WAAWJ,MAAtB;AACA,QAAIyC,SAASpC,WAAWJ,IAAxB;AACAC,QAAIc,KAAJ,CAAU,mBAAV,IAAiC,gBAAgByB,MAAhB,GAAyB,KAA1D;AACA9B,YAAQP,QAAR;AACAQ,eAAWF,WAAX;AACAR,QAAIwC,aAAJ,CAAkBvC,MAAlB;AACH,CAfD;;AAiBA,IAAIwC,iBAAiB,UAAUX,KAAV,EAAiB;AAClC;AACA,QAAI,CAAC3B,QAAL,EAAe;AACX;AACH;AACD2B,UAAMM,cAAN;AACA,QAAIG,SAASpC,WAAWJ,IAAxB;AACA;AACA,QAAI2C,WAAW,IAAIX,IAAJ,GAAWC,OAAX,KAAuBnC,SAAtC;AACA;AACA,QAAI8C,gBAAgBzC,WAAWI,MAA/B;AACA,QAAIoC,WAAW,GAAX,IAAkBL,KAAKC,GAAL,CAASK,aAAT,IAA0B,EAAhD,EAAoD;AAChD,YAAIC,QAAQP,KAAKC,GAAL,CAASK,aAAT,IAA0BD,QAAtC;AAAA,YACIG,WADJ,CADgD,CAE9B;AAClB;AACAA,sBAAeD,QAAQA,KAAT,IAAmB,IAAIxC,YAAvB,KAAwCuC,gBAAgB,CAAhB,GAAoB,CAAC,CAArB,GAAyB,CAAjE,CAAd;AACAJ,kBAAUM,WAAV;AACH;AACD;AACA,QAAIN,SAASlC,QAAb,EAAuB;AACnBkC,iBAASlC,QAAT;AACH;AACD;AACA,QAAIkC,SAAS,CAAChC,QAAd,EAAwB;AACpBgC,iBAAS,CAAChC,QAAV;AACH;AACDP,QAAIc,KAAJ,CAAU,oBAAV,IAAkC,QAAlC;AACAd,QAAIc,KAAJ,CAAU,0BAAV,IAAwC,UAAxC;AACA;AACAgC,eAAW,MAAK;AACZ9C,YAAIc,KAAJ,CAAU,mBAAV,IAAiC,gBAAgByB,MAAhB,GAAyB,KAA1D;AACH,KAFD,EAEG,CAFH;AAGAvC,QAAIwC,aAAJ,CAAkBvC,MAAlB;AACH,CAjCD;AAkCA;AACA,IAAI8C,aAAa,UAAUC,CAAV,EAAa;AAC1BA,QAAIA,KAAKpB,OAAOE,KAAhB;AACA,QAAIkB,KAAKA,EAAEZ,cAAX,EAA2B;AACvBY,UAAEZ,cAAF;AACAY,UAAEC,eAAF;AACH,KAHD,MAGO;AACHD,UAAEE,WAAF,GAAgB,KAAhB;AACA,eAAO,KAAP;AACH;AACJ,CATD;;AAWA,OAAO,IAAIC,SAAS;AAChB;AACAC,UAAM,UAAUC,EAAV,EAAcC,OAAd,EAAuBC,KAAvB,EAA8B;AAChC;AACH,KAJe;AAKhBC,cAAU,UAAUH,EAAV,EAAcC,OAAd,EAAuB;AAC7BtD,cAAMqD,EAAN;AACA9C,mBAAWP,IAAIyD,YAAJ,GAAmBjC,SAASkC,eAAT,CAAyBD,YAAvD;AACA,YAAIE,cAAczC,qBAAqBlB,GAArB,CAAlB;AACA;AACA2D,oBAAYC,gBAAZ,CAA6B,YAA7B,EAA2C,UAAUZ,CAAV,EAAa;AACpDD,uBAAWC,CAAX;AACH,SAFD;AAGA;AACAW,oBAAYC,gBAAZ,CAA6B,gBAA7B,EAA+C,UAAUZ,CAAV,EAAa;AACxDD,uBAAWC,CAAX;AACH,SAFD;;AAIAxB,iBAASkC,eAAT,CAAyB5C,KAAzB,CAA+B,UAA/B,IAA6C,QAA7C,CAb6B,CAa2B;AACxD;AACAb,iBAAS,IAAI4D,KAAJ,CAAU,UAAV,CAAT;AACAR,WAAGO,gBAAH,CAAoB,YAApB,EAAkC/B,gBAAlC;AACAwB,WAAGO,gBAAH,CAAoB,WAApB,EAAiCzB,eAAjC;AACAkB,WAAGO,gBAAH,CAAoB,UAApB,EAAgCnB,cAAhC;AACH,KAxBe;AAyBhBqB,YAAQ,UAAUT,EAAV,EAAcC,OAAd,EAAuB;AAC3B;AACH,KA3Be;AA4BhBS,sBAAkB,UAAUV,EAAV,EAAcC,OAAd,EAAuB;AACrC;AACH,KA9Be;AA+BhBU,YAAQ,UAAUX,EAAV,EAAcC,OAAd,EAAuB;AAC3B;AACH;AAjCe,CAAb","file":"scroll.js","sourceRoot":"/Users/yejiaming/Desktop/jmyour/vue-ui","sourcesContent":["/**\n * Created by yejiaming on 2017/9/28.\n */\n/**\n * Created by yejiaming on 2017/2/23.\n */\nvar startTime, startY, oldY, $el, $event, currentY, distance, deceleration = 0.0006, minValue = 0, resetY, maxValue, currentTime, lastY = 0, lastTime;\n\nvar getTranslateY = function (dom) {\n    var transformString = dom.style.transform;\n    if (transformString) {\n        return Number(transformString.match(/\\+?\\-?\\d+/g)[0]);\n    } else {\n        return 0;\n    }\n};\nvar getScrollEventTarget = function (element) {\n    let currentNode = element;\n    while (currentNode && currentNode.tagName !== 'HTML' &&\n    currentNode.tagName !== 'BODY' && currentNode.nodeType === 1) {\n        let overflowY = document.defaultView.getComputedStyle(currentNode).overflowY;\n        if (overflowY === 'scroll' || overflowY === 'auto') {\n            return currentNode;\n        }\n        currentNode = currentNode.parentNode;\n    }\n    return window;\n};\n\nvar handleTouchStart = function (event) {\n    lastTime = startTime = new Date().getTime();\n    distance = 0;\n    resetY = startY = event.targetTouches[0].screenY;\n    /*每次移动开始时设置初始的oldY的值*/\n    oldY = getTranslateY($el);\n    $el.style[\"transitionDuration\"] = '0ms';\n};\n\nvar handleTouchMove = function (event) {\n    event.preventDefault();\n    currentY = event.targetTouches[0].screenY;\n    currentTime = new Date().getTime();\n    // 二次及以上次数滚动（间歇性滚动）时间和路程重置计算，0.05是间歇性滚动的停顿位移和时间比\n    if (Math.abs(currentY - lastY) / Math.abs(currentTime - lastTime) < 0.05) {\n        startTime = new Date().getTime();\n        resetY = currentY;\n    }\n    distance = currentY - startY;\n    let temDis = distance + oldY;\n    $el.style[\"-webkit-transform\"] = 'translateY(' + temDis + 'px)';\n    lastY = currentY;\n    lastTime = currentTime;\n    $el.dispatchEvent($event);\n};\n\nvar handleTouchEnd = function (event) {\n    /*点透事件允许通过*/\n    if (!distance) {\n        return;\n    }\n    event.preventDefault();\n    let temDis = distance + oldY;\n    /*计算缓动值*/\n    var duration = new Date().getTime() - startTime;\n    // 300毫秒是判断间隔的最佳时间\n    var resetDistance = currentY - resetY;\n    if (duration < 300 && Math.abs(resetDistance) > 10) {\n        var speed = Math.abs(resetDistance) / duration,\n            destination;  // 加速度因子\n        // 初速度为0 距离等于速度的平方除以2倍加速度\n        destination = (speed * speed) / (2 * deceleration) * (resetDistance < 0 ? -1 : 1);\n        temDis += destination;\n    }\n    /*设置最小值*/\n    if (temDis > minValue) {\n        temDis = minValue;\n    }\n    /*设置最大值*/\n    if (temDis < -maxValue) {\n        temDis = -maxValue;\n    }\n    $el.style[\"transitionDuration\"] = '1000ms';\n    $el.style[\"transitionTimingFunction\"] = 'ease-out';\n    /*确定最终的滚动位置*/\n    setTimeout(()=> {\n        $el.style[\"-webkit-transform\"] = 'translateY(' + temDis + 'px)';\n    }, 0);\n    $el.dispatchEvent($event);\n};\n// 禁用滚轮滚动\nvar scrollFunc = function (e) {\n    e = e || window.event;\n    if (e && e.preventDefault) {\n        e.preventDefault();\n        e.stopPropagation();\n    } else {\n        e.returnvalue = false;\n        return false;\n    }\n}\n\nexport var scroll = {\n    // 当绑定元素插入到 DOM 中。\n    bind: function (el, binding, vnode) {\n        // console.log('首次加载挂载到DOM节点中——一次挂载之运行一次');\n    },\n    inserted: function (el, binding) {\n        $el = el;\n        maxValue = $el.clientHeight - document.documentElement.clientHeight;\n        var scrollTarge = getScrollEventTarget($el);\n        // IE和webkit下鼠标滚动事件\n        scrollTarge.addEventListener('mousewheel', function (e) {\n            scrollFunc(e);\n        });\n        //火狐下的鼠标滚动事件\n        scrollTarge.addEventListener('DOMMouseScroll', function (e) {\n            scrollFunc(e);\n        });\n\n        document.documentElement.style['overflow'] = 'hidden';  // 禁用根节点（html）的滚动条\n        // console.log('DOM节点挂载到完毕——一次挂载之运行一次');\n        $event = new Event('y-scroll');\n        el.addEventListener('touchstart', handleTouchStart);\n        el.addEventListener('touchmove', handleTouchMove);\n        el.addEventListener('touchend', handleTouchEnd);\n    },\n    update: function (el, binding) {\n        // console.log('更新DOM节点或者绑定数据——一次挂载之运行多次');\n    },\n    componentUpdated: function (el, binding) {\n        // console.log('完成更新DOM节点或者绑定数据——一次挂载之运行多次');\n    },\n    unbind: function (el, binding) {\n        // console.log('取消该节点的挂载——一次挂载之运行一次');\n    }\n};\n"]}
{"version":3,"sources":["src/modules/directives/scroll.js"],"names":["startTime","startY","oldY","$el","$event","currentY","distance","deceleration","minValue","maxValue","getTranslateY","dom","transformString","style","transform","Number","match","getScrollEventTarget","element","currentNode","tagName","nodeType","overflowY","document","defaultView","getComputedStyle","parentNode","window","handleTouchStart","event","preventDefault","Date","getTime","targetTouches","screenY","handleTouchMove","Math","abs","temDis","dispatchEvent","handleTouchEnd","duration","speed","destination","setTimeout","scrollFunc","e","stopPropagation","returnvalue","scroll","bind","el","binding","vnode","inserted","clientHeight","documentElement","scrollTarge","addEventListener","body","Event","update","componentUpdated","unbind"],"mappings":"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","file":"scroll.js","sourceRoot":"/Users/yejiaming/Desktop/jmyour/vue-ui","sourcesContent":["/**\n * Created by yejiaming on 2017/9/28.\n */\n/**\n * Created by yejiaming on 2017/2/23.\n */\nvar startTime, startY, oldY, $el, $event, currentY, distance, deceleration = 0.0006, minValue = 0, maxValue;\n\nvar getTranslateY = function (dom) {\n    var transformString = dom.style.transform;\n    if (transformString) {\n        return Number(transformString.match(/\\+?\\-?\\d+/g)[0]);\n    } else {\n        return 0;\n    }\n};\nvar getScrollEventTarget = function (element) {\n    let currentNode = element;\n    while (currentNode && currentNode.tagName !== 'HTML' &&\n    currentNode.tagName !== 'BODY' && currentNode.nodeType === 1) {\n        let overflowY = document.defaultView.getComputedStyle(currentNode).overflowY;\n        if (overflowY === 'scroll' || overflowY === 'auto') {\n            return currentNode;\n        }\n        currentNode = currentNode.parentNode;\n    }\n    return window;\n};\n\nvar handleTouchStart = function (event) {\n    event.preventDefault();\n    startTime = new Date().getTime();\n    startY = event.targetTouches[0].screenY;\n    /*每次移动开始时设置初始的oldY的值*/\n    oldY = getTranslateY($el);\n    $el.style[\"transitionDuration\"] = '0ms';\n};\n\nvar handleTouchMove = function (event) {\n    event.preventDefault();\n    currentY = event.targetTouches[0].screenY;\n    distance = currentY - startY;\n    if (Math.abs(distance) <= 10) {\n        return;\n    }\n    let temDis = distance + oldY;\n    $el.style[\"-webkit-transform\"] = 'translateY(' + temDis + 'px)';\n    $el.dispatchEvent($event);\n};\n\nvar handleTouchEnd = function (event) {\n    event.preventDefault();\n    let temDis = distance + oldY;\n    /*计算缓动值*/\n    var duration = new Date().getTime() - startTime;\n    // 300毫秒是判断间隔的最佳时间\n    if (duration < 300 && Math.abs(distance) > 10) {\n        var speed = Math.abs(distance) / duration,\n            destination;  // 加速度因子\n        // 初速度为0 距离等于速度的平方除以2倍加速度\n        destination = (speed * speed) / (2 * deceleration) * (distance < 0 ? -1 : 1);\n        // 初始时间为0，初始速度为0 时间等于速度除以加速度\n        duration = speed / deceleration;\n        temDis += destination;\n    }\n    /*设置最小值*/\n    if (temDis > minValue) {\n        temDis = minValue;\n    }\n    /*设置最大值*/\n    if (temDis < -maxValue) {\n        temDis = -maxValue;\n    }\n    $el.style[\"transitionDuration\"] = '1000ms';\n    $el.style[\"transitionTimingFunction\"] = 'ease-out';\n    /*确定最终的滚动位置*/\n    setTimeout(()=> {\n        $el.style[\"-webkit-transform\"] = 'translateY(' + temDis + 'px)';\n    }, 0);\n    $el.dispatchEvent($event);\n};\n// 禁用滚轮滚动\nvar scrollFunc = function (e) {\n    e = e || window.event;\n    if (e && e.preventDefault) {\n        e.preventDefault();\n        e.stopPropagation();\n    } else {\n        e.returnvalue = false;\n        return false;\n    }\n}\n\nexport var scroll = {\n    // 当绑定元素插入到 DOM 中。\n    bind: function (el, binding, vnode) {\n        // console.log('首次加载挂载到DOM节点中——一次挂载之运行一次');\n    },\n    inserted: function (el, binding) {\n        $el = el;\n        maxValue = $el.clientHeight - document.documentElement.clientHeight;\n        var scrollTarge = getScrollEventTarget($el);\n        // IE和webkit下鼠标滚动事件\n        scrollTarge.addEventListener('mousewheel', function (e) {\n            scrollFunc(e);\n        });\n        //火狐下的鼠标滚动事件\n        scrollTarge.addEventListener('DOMMouseScroll', function (e) {\n            scrollFunc(e);\n        });\n        document.body.style['overflow'] = 'hidden';\n        // console.log('DOM节点挂载到完毕——一次挂载之运行一次');\n        $event = new Event('y-scroll');\n        el.addEventListener('touchstart', handleTouchStart);\n        el.addEventListener('touchmove', handleTouchMove);\n        el.addEventListener('touchend', handleTouchEnd);\n    },\n    update: function (el, binding) {\n        // console.log('更新DOM节点或者绑定数据——一次挂载之运行多次');\n    },\n    componentUpdated: function (el, binding) {\n        // console.log('完成更新DOM节点或者绑定数据——一次挂载之运行多次');\n    },\n    unbind: function (el, binding) {\n        // console.log('取消该节点的挂载——一次挂载之运行一次');\n    }\n};\n"]}
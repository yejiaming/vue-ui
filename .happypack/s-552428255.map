{"version":3,"sources":["src/modules/utils/scroll.js"],"names":["Scroll","el","me","$el","startTime","startY","oldY","$event","currentY","distance","deceleration","minValue","resetY","maxValue","currentTime","lastY","lastTime","hiddenDom","getStyleTargetDom","clientHeight","document","defaultView","getComputedStyle","documentElement","scrollTarge","addEventListener","e","scrollFunc","style","Event","handleTouchStart","bind","handleTouchMove","handleTouchEnd","prototype","element","attr","value","currentNode","tagName","nodeType","target","indexOf","parentNode","window","event","preventDefault","stopPropagation","returnvalue","getTranslateY","dom","transformString","transform","getPxValue","str","Number","String","match","Date","getTime","targetTouches","screenY","Math","abs","temDis","dispatchEvent","duration","resetDistance","speed","destination","setTimeout"],"mappings":"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","file":"scroll.js","sourceRoot":"/Users/yejiaming/Desktop/jmyour/vue-ui","sourcesContent":["/**\n * Created by yejiaming on 2017/10/14.\n * Scroll自定义滚动事件\n */\nexport function Scroll(el) {\n    var me = this;\n    me.$el = el;\n    me.startTime = 0;\n    me.startY = 0;\n    me.oldY = null;\n    me.$event = null;\n    me.currentY = null;\n    me.distance = null;\n    me.deceleration = 0.0006;\n    me.minValue = 0;\n    me.resetY = null;\n    me.maxValue = null;\n    me.currentTime = null;\n    me.lastY = 0;\n    me.lastTime = 0;\n\n    var hiddenDom = me.getStyleTargetDom(me.$el, 'overflowY', 'hidden');\n    var clientHeight = document.defaultView.getComputedStyle(hiddenDom)['height'] < document.documentElement.clientHeight ? document.defaultView.getComputedStyle(hiddenDom)['height'] : document.documentElement.clientHeight;\n    me.maxValue = el.clientHeight - clientHeight;\n    var scrollTarge = me.getStyleTargetDom(me.$el, 'overflowY', ['scroll', 'auto']);\n    // IE和webkit下鼠标滚动事件\n    scrollTarge.addEventListener('mousewheel', function (e) {\n        me.scrollFunc(e);\n    });\n    //火狐下的鼠标滚动事件\n    scrollTarge.addEventListener('DOMMouseScroll', function (e) {\n        me.scrollFunc(e);\n    });\n    document.documentElement.style['overflow'] = 'hidden';  // 禁用根节点（html）的滚动条\n\n    // 自定义滚动事件\n    me.$event = new Event('y-scroll');\n\n    el.addEventListener('touchstart', me.handleTouchStart.bind(me), false);\n    el.addEventListener('touchmove', me.handleTouchMove.bind(me), false);\n    el.addEventListener('touchend', me.handleTouchEnd.bind(me), false);\n\n    // console.log('DOM节点挂载到完毕——一次挂载之运行一次');\n}\n\nScroll.prototype = {\n    // 获取想要的参数的目标节点，并指定属性以及属性值\n    getStyleTargetDom: function (element, attr, value) {\n        let currentNode = element;\n        while (currentNode && currentNode.tagName !== 'HTML' &&\n        currentNode.tagName !== 'BODY' && currentNode.nodeType === 1) {\n            let target = document.defaultView.getComputedStyle(currentNode)[attr];\n            if (value && value.indexOf(target) > -1) {\n                return currentNode;\n            }\n            currentNode = currentNode.parentNode;\n        }\n        return window;\n    },\n    // 阻止事件的冒泡\n    scrollFunc: function (e) {\n        e = e || window.event;\n        if (e && e.preventDefault) {\n            e.preventDefault();\n            e.stopPropagation();\n        } else {\n            e.returnvalue = false;\n            return false;\n        }\n    },\n    // 获取dom节点的TranslateY的值\n    getTranslateY(dom){\n        var transformString = dom.style.transform;\n        if (transformString) {\n            return this.getPxValue(transformString);\n        } else {\n            return 0;\n        }\n    },\n    // 获取100px中100的值\n    getPxValue(str){\n        return Number(String(str).match(/\\+?\\-?\\d+/g)[0]);\n    },\n    handleTouchStart(event){\n        this.lastTime = this.startTime = new Date().getTime();\n        this.distance = 0;\n        this.resetY = this.startY = event.targetTouches[0].screenY;\n        /*每次移动开始时设置初始的oldY的值*/\n        this.oldY = this.getTranslateY(this.$el);\n        this.$el.style[\"transitionDuration\"] = '0ms';\n        this.scrollFunc(event);\n    },\n    handleTouchMove(event){\n        event.preventDefault();\n        this.currentY = event.targetTouches[0].screenY;\n        this.currentTime = new Date().getTime();\n        // 二次及以上次数滚动（间歇性滚动）时间和路程重置计算，0.05是间歇性滚动的停顿位移和时间比\n        if (Math.abs(this.currentY - this.lastY) / Math.abs(this.currentTime - this.lastTime) < 0.05) {\n            this.startTime = new Date().getTime();\n            this.resetY = this.currentY;\n        }\n        this.distance = this.currentY - this.startY;\n        let temDis = this.distance + this.oldY;\n        this.$el.style[\"-webkit-transform\"] = 'translateY(' + temDis + 'px)';\n        this.lastY = this.currentY;\n        this.lastTime = this.currentTime;\n        this.$el.dispatchEvent(this.$event);\n        this.scrollFunc(event);\n    },\n    handleTouchEnd(event){\n        /*点透事件允许通过*/\n        if (!this.distance) {\n            return;\n        }\n        event.preventDefault();\n        let temDis = this.distance + this.oldY;\n        /*计算缓动值*/\n        var duration = new Date().getTime() - this.startTime;\n        // 300毫秒是判断间隔的最佳时间\n        var resetDistance = this.currentY - this.resetY;\n        if (duration < 300 && Math.abs(resetDistance) > 10) {\n            var speed = Math.abs(resetDistance) / duration,\n                destination;\n            // 初速度为0 距离等于速度的平方除以2倍加速度\n            destination = (speed * speed) / (2 * this.deceleration) * (resetDistance < 0 ? -1 : 1);\n            temDis += destination;\n        }\n        /*设置最小值*/\n        if (temDis > this.minValue) {\n            temDis = this.minValue;\n        }\n        /*设置最大值*/\n        if (temDis < -this.maxValue) {\n            temDis = -this.maxValue;\n        }\n        this.$el.style[\"transitionDuration\"] = '1000ms';\n        this.$el.style[\"transitionTimingFunction\"] = 'ease-out';\n        /*确定最终的滚动位置*/\n        setTimeout(()=> {\n            this.$el.style[\"-webkit-transform\"] = 'translateY(' + temDis + 'px)';\n        }, 0);\n        this.$el.dispatchEvent(this.$event);\n        this.scrollFunc(event);\n    }\n};"]}